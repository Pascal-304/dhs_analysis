---
title: "paper"
author: 
  - Pascal Lee Slew
  - Yunkyung Park
thanks: "Code and data are available at: https://github.com/Pascal-304/dhs_analysis."
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "Four sentences"
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library, echo=FALSE, message=FALSE}
# install.packages('bookdown')
# install.packages("stringr")
#install.packages("ggforce")
library(stringr) 
library(dplyr)
library(tidyverse) 
library(janitor)
library(ggplot2)
library(knitr)
library(kableExtra)
library(bookdown)
library(ggforce)
```

```{r readdata, echo=FALSE}
ghana <- read_csv('data/cleaned_data.csv', show_col_types = FALSE)
```

# Introduction

# Data

```{r total, echo=FALSE, fig.cap="Data"}
ghana %>%
  mutate(
    character = factor(character,
                       levels = c("Residence",
                                "Region",
                                "Mother\'s_education",
                                "Work_status",
                                "Occupation",
                                "Employment_status",
                                "Total"
                                )
                       )
           ) %>%
  group_by(character) %>%
  summarise(sum = sum(number_of_employed_women))
```

Table \@ref(tab:total) shows that 3,566 participated the survey, but there are 3 whom did not answer their employment status, etc.

## Key features

```{r data, echo=FALSE}
ghana %>%
  select(background, no_child_under_six, one_more_child_under_six, caretaker_respondent, character) %>%
  slice(5:6, 13:20) %>%
  kable(caption='A subset of key features',
        col.names = c('Background', 'No child under six', '1+ child under six', 
                      'Child\'s caretaker- respondent', 'Category'),
        digits = 1,
        booktabs = FALSE,
        linesep = "") %>%
  add_footnote("Numbers are in percentage (%).")
```

The raw data contains the table created in 
Some key features include background, no child under six, one or more child under six, and character. If the respondent answered to have one or more child under six, then they were further asked to indicate the caretaker of the child such as the respondent themselves, their partner, whether they hired a person for it, etc. The dataset is processed and analyzed using 'R' [@citeR] mainly with the 'tidyverse' [@citetidyverse] and 'dplyr' [@citedplyr] packages. The package 'janitor' [@citejanitor] is used to clean data, and the graphs and the tables are created in 'ggplot2' [@citeggplot2] and 'ggforce' [@citeggforce], and 'kableExtra' [@citekableExtra], respectively. The package 'stringr' [@citestringr] is used to manipulate the character string. The packages 'bookdown' [@citebookdown] and 'knitr' [@citeknitr] are used in generating the R Markdown report. Table \@ref(tab:data) created using 'kableExtra' [@citekableExtra] shows a subset of key features that will be discussed in this paper.

# Results

## Region

```{r map, message=FALSE, echo = FALSE, warning=FALSE, fig.cap="Ghana administrative regions"}
# install.packages('rnaturalearth')
# install.packages('sf')
library(rnaturalearth) # we need to cite these packages as well
library(sf)
# devtools::install_github("ropensci/rnaturalearthhires")
# The st_centroid function takes the sf object and returns the center of 
# the polygon, again as a sf object.
map_ghana <- ne_states(country = 'Ghana', 
                       returnclass = 'sf')  # grab provinces within Ghana

map_ghana %>% 
  ggplot() +
  geom_sf( ) + 
  geom_text(data = st_centroid(map_ghana), 
            size = 3,
             aes(x = longitude, 
                 y = latitude,
                 label= woe_name)) +
  theme_minimal()
```

Figure \@ref(fig:map) shows a map of Ghana and its administrative regions. Ghana has 10 administrative regions, namely, Upper West, Upper East, Northern, Brong Ahato, Western, Ashanti, Central, Eastern, Volta and Greater Accra. # Add details on largest provinces + population wise 

```{r residence, echo=FALSE, fig.cap="Comparison of the number of working mothers between urban and rural areas"}
# Urban vs Rural

# Obtain subset of dataset for residence area
residence <- ghana %>% 
  filter(character == 'Residence')

# look at survey respondents distribution in urban and rural areas
residence %>% 
  ggplot(aes(x = background, y = number_of_employed_women)) +
  geom_bar(stat = 'identity', fill = "burlywood") +
  labs(x = "Area",
       y = "Number of employed women") +
  theme_minimal()
```

Figure \@ref(fig:residence) shows the number of employed mothers in urban and rural areas. There are 1127 women who were selected in Urban areas while 2338 mothers were selected in rural areas. This is not surprising since a larger population live in rural areas.



```{r region, echo=FALSE, fig.cap = "Comparison of the number of working mothers selected in the different administrative regions"}
# region subdataset
region <- ghana %>% 
  filter(character == "Region") %>% 
  mutate(background = recode(background,
                             'Western' = 'Western',
                             'Central' = 'Central',
                             'Greater_Accra' = 'Greater Accra',
                             'Volta' = 'Volta',
                             'Eastern' = 'Eastern',
                             'Ashanti' = 'Ashanti',
                             'Brong_Ahafo' = 'Brong Ahafo',
                             'Northen' = 'Northern',
                             'Upper_West' = 'Upper West',
                             'Upper_East' = 'Upper East'))

# number of survey respondents in the different administrative regions
region %>% 
  ggplot(aes(x = background,
             y = number_of_employed_women)) +
  geom_bar(stat = 'identity',
           fill = 'burlywood') +
  labs(x = "Administrative regions",
       y = "Number of employed women") +
  theme_minimal() +
  coord_flip()
```

Figure @\ref(fig:region) shows the number of employed mothers in the different administrative regions. There were more working mothers in Greater Accra and Ashanti while Upper West had the least number of working mothers. The reason might be because of the number of people living in the different administrative regions are different, therefore, the population sample differed from one region to another.


```{r childstatus, echo = FALSE, fig.cap = "Comparing the percentage of mothers having no child under six to one or more in both Urban and Rural areas"}
# make dataset in long format
resid_long <- residence %>% 
  select(-c(character)) %>% 
  pivot_longer(!background, names_to = "variables", values_to = "percentage") %>% 
  mutate(variables = recode(variables,
                            'no_child_under_six' = "No child under six", 
                            'one_more_child_under_six' = "One or more child under six",
                            'caretaker_respondent' = 'respondent',
                             'caretaker_partner' = 'partner',
                             'caretaker_other_relative' = 'other relative',
                             'caretaker_other_male_child' = 'other male child',
                             'caretaker_other_female_child' = 'other female child',
                             'caretaker_other' = 'other',
                             'caretaker_not_worked since_birth' = 'not worked since birth',
                             'caretaker_neighbor' = 'neighbour',
                             'caretaker_missing' = 'missing',
                             'caretaker_hired' = 'hired',
                             'caretaker_child_in_school' = 'child in school'))

# create label names list
label_list <- list('no_child_under_six' = "No child under six", 
                   'one_more_child_under_six' = "One or more child under six")

labellers <- function(variable, value) {
  return(label_list[value])
}

# plot bar graph
resid_long %>% 
  filter(variables == 'No child under six' | variables == 'One or more child under six') %>% 
  ggplot(aes(x = background, 
             y = percentage,
             fill = variables)) +
  geom_bar(stat = 'identity',
           position = 'dodge') +
  labs(x = "Area",
       y = "Percentage",
       fill = "Child status") +
  theme_minimal() +
  scale_fill_brewer() +
  theme(legend.position = "bottom")

```

Figure \@ref(fig:childstatus) shows the child status of families in Urban and Rural areas. In rural areas, there is a larger percentage of working mothers having one or more child under six years old. The converse is true in Urban areas. Working mothers tend to have no child under six years old.


```{r areachildcare, echo=FALSE, fig.cap = "Comparing child caretaker preferences in Urban and Rural areas"}
# caretaker aspect
# make dataset into long format
# rename 
caretaker <- residence %>% 
  select(-c(character, no_child_under_six, one_more_child_under_six, total, number_of_employed_women, caretaker_missing)) %>% 
  pivot_longer(!background, names_to = "caretakers", values_to = "percentage") %>% 
  mutate(caretakers = recode(caretakers,
                             'caretaker_respondent' = 'respondent',
                             'caretaker_partner' = 'partner',
                             'caretaker_other_relative' = 'other relative',
                             'caretaker_other_male_child' = 'other male child',
                             'caretaker_other_female_child' = 'other female child',
                             'caretaker_other' = 'other',
                             'caretaker_not_worked_since_birth' = 'not worked since birth',
                             'caretaker_neighbor' = 'neighbour',
                             'caretaker_missing' = 'missing',
                             'caretaker_hired' = 'hired',
                             'caretaker_child_in_school' = 'child in school'))

# plot bar graph
caretaker %>% 
  ggplot(aes(x = caretakers, 
             y = percentage,
             fill = background)) +
  geom_bar(stat = 'identity',
           position = "dodge") +
  labs(x = "Caretaker",
       y = "Percentage of women",
       fill = "Area") +
  theme_minimal() +
  coord_flip() +
  scale_fill_brewer(palette = "Set1") +
  theme(legend.position = "bottom")

```

Figure @\ref(fig:areachildcare) shows the Ghanese families'caretaking preferences in both urban and rural areas. The preferred caretaking method in both urban and rural areas is the working mothers looking after their children by themselves. The next preferred method for in both areas would be to let the children be looked after by relatives. Other notable observations would be that families living in urban areas tend to put their child in school and in rural areas, families let the older female child to care for the under six years old child much more than in urban areas.


## Also comparison among the different administrative regions

```{r caretakingregions, echo = FALSE, fig.cap = "Caretaking behaviour in the different administrative regions"}
# make dataset into long format
# recode names
child <- region %>% 
  select(-c(character, total, caretaker_missing)) %>% 
  pivot_longer(!background, names_to = "x", values_to = "percentage") %>% 
  mutate(x = recode(x,
                    'caretaker_respondent' = 'respondent',
                    'caretaker_partner' = 'partner',
                    'caretaker_other_relative' = 'other relative',
                    'caretaker_other_male_child' = 'other male child',
                    'caretaker_other_female_child' = 'other female child',
                    'caretaker_other' = 'other',
                    'caretaker_not_worked_since_birth' = 'not worked since birth',
                    'caretaker_neighbor' = 'neighbour',
                    'caretaker_missing' = 'missing',
                    'caretaker_hired' = 'hired',
                    'caretaker_child_in_school' = 'child in school',
                    'no_child_under_six' = 'no child under six',
                    'one_more_child_under_six' = 'one or more child under six',
                    'number_of_employed_women' = 'number of employed women'))

# plot bar graph for caretaker comparisons and administrative regions
child %>% 
  filter(x != 'number of employed women', x != 'no child under six', x!= 'one or more child under six') %>% 
  ggplot(aes(x = x,
             y = percentage,
             fill = background)) +
  geom_bar(stat = 'identity') + 
  labs(x = "caretaking preference",
       y = "percentage",
       fill = "Administrative regions") +
  theme_minimal() +
  coord_flip() +
  facet_wrap(~background) +
  theme(legend.position = "bottom")

```

Figure \@ref(fig:caretakingregions) shows the caretaking preference of Ghanese families in the different administrative regions. Working mothers tend to look after their child themselves the most in all regions. In Greater Accra, families choose to put their child in school the most compared to other administrative regions. Another observation is that the proportions of families opting to put their child in school in Northern, Upper East and Upper West are the lowest, namely 1.3%, 2.7% and 2.0% respectively. The other popular caretaking options after by the mother herself are by a relative or by another older female child. 



```{r chstatus, echo = FALSE, fig.cap = "Comparing the child status in different administrative regions"}
# looking at the number of employed women selected in the different administrative regions
# with the child under six
child %>% 
  filter(x == "no child under six" | x == "one or more child under six") %>% 
  ggplot(aes(x = x,
             y = percentage,
             fill = background)) +
  geom_bar(stat = 'identity') +
  labs(x = "child status",
       y = "percentage",
       fill = "region") +
  theme_minimal() +
  theme(legend.position = "bottom") +
  coord_flip() +
  facet_wrap(~background)

```

Figure \@ref(fig:chstatus) shows the child status of Ghanese families in the different administrative regions. By child status, we mean the whether the families have children under six years old. Ghanese families tend to have one or more child under six years old more than no child under six with the exception of Greater Accra. The proportion of families with one or more child under six is slightly more pronounced in Northern, Upper West, Brong Ahafo and Upper East regions.

## Mother's education

```{r motheredu, echo=FALSE, fig.cap="Mother's Education level", fig.width=6, fig.height=4}
# select mother edu
mother_edu <-
  ghana %>%
  filter(character=="Mother\'s_education") %>%
  mutate(
    no_child_under_six = round(no_child_under_six/100 * number_of_employed_women, 0),
    one_more_child_under_six = round(one_more_child_under_six/100 * number_of_employed_women, 0)
  )

# make dataset in long format
edu_long <-
  mother_edu %>%
  select(-c(character, total)) %>%
  pivot_longer(!background, names_to = "variable", values_to = "count") %>%
  mutate(
    background = factor(background,
                        levels = c('No_education',
                                   'Primary',
                                   'Middle',
                                   'Secondary+')
    )
  )

edu_long %>%
  filter(variable == 'no_child_under_six' | variable == 'one_more_child_under_six') %>%
  ggplot(aes(x = background, y = count, fill = variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Mother's education", y = "Number of employed women", fill = "Child under six") +
  theme_minimal() +
  scale_fill_discrete(labels = c("No child under six", 
                                 "One or more child under six")) +
  scale_x_discrete(labels = c("No_education" = "No education")) +
  theme(legend.position = 'bottom')
```

Figure \@ref(fig:motheredu) shows that there are significantly less employed women who studied at secondary school and beyond it. Also, it can be observed that the employed women who did not continue their education until the secondary school are more likely to have a child under six, whereas there are more employed women who studied beyond the secondary school and have no child under six. In addition, when we take a look at the number of employed women who did not get any education, we can see that there are a lot more women with a child under six than without, and the difference between them is notably big. However, as the level of mother's education gets higher, the gap between having a child under six and no child under six decreases, and it gets reversed when the women completed the secondary school.

```{r mothereduchildcare, echo=FALSE, fig.cap="Distribution of child's caretaker by mother's education level"}
# caretaker aspect
edu_caretaker <-
  edu_long %>%
  filter(str_detect(variable, "^caretaker_")) %>%
  mutate(variable = str_replace_all(variable, "caretaker_", "")) %>%
  rename(caretaker = variable,
         percentage = count) %>%
  mutate(
    caretaker = factor(caretaker, 
                       levels = c('respondent',
                                  'partner',
                                  'other_relative',
                                  'neighbor',
                                  'hired',
                                  'child_in_school',
                                  'other_female_child',
                                  'other_male_child',
                                  'not_worked_since_birth',
                                  'other',
                                  'missing')
    )
  )

# plot the bar graph
edu_caretaker %>%
  ggplot(mapping=aes(x=caretaker, y=percentage, fill=caretaker)) +
  geom_bar(stat = "identity", position="dodge") + 
  theme_minimal() +
  labs(x='',
       caption = 'Respondent is currently employed but has not worked since last birth.') +
  theme(legend.position='none') +
  coord_flip() + 
  scale_x_discrete(
    labels = 
      c("respondent" = "respondent",
        "partner" = "partner",
        "other_relative" = "relative",
        "neighbor" = "neighbor",
        "hired" = "hired",
        "child_in_school" = "schooling",
        "other_female_child" = "female child",
        "other_male_child" = "male child",
        "not_worked_since_birth" = "not worked since birth",
        "other" = "other",
        "missing" = "missing")
  ) +
  facet_wrap(vars(background),
             dir = "v",
             scales = "free",
             labeller = labeller(background = 
                                   c("No_education" = "No education",
                                     "Primary" = "Primary",
                                     "Middle" = "Middle",
                                     "Secondary+" = "Secondary+")
                                 )
  )
```

Figure \@ref(fig:mothereduchildcare) demonstrates that no matter what their education level is, it is mostly the employed women who take care of their children. When the level of the women's education is below high school, then it is followed by the relative. As the level of the women's education gets higher, then the percentage of schooling their children gets higher as well. Moreover, it is worthwhile to mention that the women who completed high school are more likely to stop working after having a birth compare to the women whose education level is lower than secondary school. 

## Work status

```{r workstatus, echo=FALSE, message=FALSE, fig.cap="Work status", fig.width=6, fig.height=4}
# select work status
work_status <-
  ghana %>%
  filter(character=="Work_status") %>%
  mutate(
    no_child_under_six = round(no_child_under_six/100 * number_of_employed_women, 0),
    one_more_child_under_six = round(one_more_child_under_six/100 * number_of_employed_women, 0)
  )

# make dataset in long format
work_long <-
  work_status %>%
  select(-c(character, total)) %>%
  pivot_longer(!background, names_to = "variable", values_to = "count") %>%
  mutate(
    background = factor(background,
                        levels = c('For_family_member',
                                   'For_someone_else',
                                   'Self-employed')
    )
  )

work_long %>%
  filter(variable == 'no_child_under_six' | variable == 'one_more_child_under_six') %>%
  ggplot(aes(x = background, y = count, fill = variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Work status", y = "Number of employed women", fill = "Child under six") +
  theme_minimal() +
  scale_x_discrete(labels = c("For_family_member" = "For family member",
                              "For_someone_else" = "For someone else")) + 
  scale_fill_discrete(labels = c("No child under six", 
                                 "One or more child under six")) +
  theme(legend.position='bottom')
```

Figure \@ref(fig:workstatus) shows that most of the employed women are self-employed. If the women work for themselves or for their family, then it is more likely to have one or more than one child under six, whereas when they work for someone else, there are more women who do not have a child under six. It should be noted that no child under six does not mean that they have no child. 

```{r workstatuschildcare, echo=FALSE, fig.cap="Distribution of child's caretaker by work status"}
# caretaker aspect
work_caretaker <-
  work_long %>%
  filter(str_detect(variable, "^caretaker_")) %>%
  mutate(variable = str_replace_all(variable, "caretaker_", "")) %>%
  rename(caretaker = variable,
         percentage = count) %>%
  mutate(
    caretaker = factor(caretaker, 
                       levels = c('respondent',
                                  'partner',
                                  'other_relative',
                                  'neighbor',
                                  'hired',
                                  'child_in_school',
                                  'other_female_child',
                                  'other_male_child',
                                  'not_worked_since_birth',
                                  'other',
                                  'missing')
    )
  )

# plot the bar graph
work_caretaker %>%
  ggplot(mapping=aes(x=caretaker, y=percentage, fill=caretaker)) +
  geom_bar(stat = "identity", position="dodge") + 
  theme_minimal() +
  labs(x='',
       caption = 'Respondent is currently employed but has not worked since last birth.') +
  theme(legend.position='none') +
  coord_flip() + 
  scale_x_discrete(
    labels = 
      c("respondent" = "respondent",
        "partner" = "partner",
        "other_relative" = "relative",
        "neighbor" = "neighbor",
        "hired" = "hired",
        "child_in_school" = "schooling",
        "other_child" = "siblings",
        "not_worked_since_birth" = "not worked since birth",
        "other" = "other",
        "missing" = "missing")
  ) +
  facet_wrap_paginate(vars(background),
                      ncol=2,
                      nrow=2,
                      dir = "h",
                      scales = "free",
                      labeller = labeller(background = c("For_family_member" = "For family member",
                                                         "For_someone_else" = "For someone else",
                                                         "Self-employed" = "Self-employed")
                      )
  )


```

It can be observed from Figure \@ref(fig:workstatuschildcare) that most of the employed women take care of their children by themselves regardless of whom they work for, and then it is their relatives who take care of their children. We can tell that if they are self-employed or work for the family, then it is more likely to have a family member taking care of their children under six, whereas the percentage of schooling their child under six is relatively higher when they work for someone else. 

## Occupation

```{r occupation, echo=FALSE, message=FALSE, fig.cap="Occupation", fig.width=6, fig.height=4}
# select occupation
occupation <-
  ghana %>%
  filter(character=="Occupation") %>%
  mutate(
    no_child_under_six = round(no_child_under_six/100 * number_of_employed_women, 0),
    one_more_child_under_six = round(one_more_child_under_six/100 * number_of_employed_women, 0)
  )

# make dataset in long format
occup_long <-
  occupation %>%
  select(-c(character, total)) %>%
  pivot_longer(!background, names_to = "variable", values_to = "count") %>%
  mutate(
    background = factor(background,
                        levels = c('Agricultural',
                                   'Nonagricultural')
    )
  )

occup_long %>%
  filter(variable == 'no_child_under_six' | variable == 'one_more_child_under_six') %>%
  ggplot(aes(x = background, 
             y = count,
             fill = variable)) +
  geom_bar(stat = "identity",
           position = "dodge") +
  labs(x = "Occupation",
       y = "Number of employed women",
       fill = "Child under six") +
  theme_minimal() +
  scale_fill_discrete(labels = c("No child under six", 
                                 "One or more child under six")) +
  theme(legend.position = 'bottom')
```

Figure \@ref(fig:occupation) shows that there are more women working in the non-agricultural industry. When they work in the agricultural industry, the number of women who have a child under six is twice as many as the number of the ones who have no child under six. On the contrary, the number of women with no child under six is slightly higher than that of the ones with a child in the non-agricultural industry. 

```{r occupationchildcare, echo=FALSE, fig.cap="Distribution of child's caretaker by Occupation"}
# caretaker aspect
occup_caretaker <-
  occup_long %>%
  filter(str_detect(variable, "^caretaker_")) %>%
  mutate(variable = str_replace_all(variable, "caretaker_", "")) %>%
  rename(caretaker = variable,
         percentage = count) %>%
  mutate(
    caretaker = factor(caretaker, 
                       levels = c('respondent',
                                  'partner',
                                  'other_relative',
                                  'neighbor',
                                  'hired',
                                  'child_in_school',
                                  'other_female_child',
                                  'other_male_child',
                                  'not_worked_since_birth',
                                  'other',
                                  'missing'))
  )


# plot bar graph
occup_caretaker %>%
  ggplot(aes(x=caretaker, y=percentage, fill=background)) +
  geom_bar(stat = "identity", position="dodge") + 
  labs(x="Caretaker", y="Percentage (in %)", fill="Occupation") +
  theme_minimal() +
  theme(legend.position='bottom') +
  coord_flip() +
  scale_x_discrete(
    labels = 
      c("respondent" = "respondent", 
        "partner" = "partner",
        "other_relative" = "relative",
        "neighbor" = "neighbor",
        "hired" = "hired",
        "child_in_school" = "schooling",
        "other_female_child" = "other female child",
        "other_male_child" = "other male child",
        "not_worked_since_birth" = "not worked since birth",
        "other" = "other",
        "missing" = "missing")
  )
```

Figure \@ref(fig:occupationchildcare) illustrates that the percentage of the child's caretaker is highest in the respondent followed by the relative and schooling. This means that it is mostly the case that the employed women taking care of their children under six. In particular, more than a half of the employed women working in the agricultural industry are the primary caretaker of the child under six. Also, we can see that it is more likely for the female sibling to take care of the kids under six than the male sibling. 

## Employment status

```{r employmentstatus, echo=FALSE, message=FALSE, fig.cap="Employment status", fig.width=6, fig.height=4}
# select employment status
employment_status <-
  ghana %>%
  filter(character=="Employment_status") %>%
  mutate(
    no_child_under_six = round(no_child_under_six/100 * number_of_employed_women, 0),
    one_more_child_under_six = round(one_more_child_under_six/100 * number_of_employed_women, 0)
  )

# make dataset in long format
emply_long <-
  employment_status %>%
  select(-c(character, total)) %>%
  pivot_longer(!background, names_to = "variable", values_to = "count") %>%
  mutate(
    background = factor(background,
                        levels = c('All_year_full_week',
                                   'All_year_part_week',
                                   'Seasonal',
                                   'Occasional'))
  )

emply_long %>%
  filter(variable == 'no_child_under_six' | variable == 'one_more_child_under_six') %>%
  ggplot(aes(x = background, y = count, fill = variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Employment status", y = "Number of employed women", fill = "Child under six") +
  theme_minimal() +
  scale_fill_discrete(labels = c("No child under six", 
                                 "One or more child under six")) +
  scale_x_discrete(labels = c("All_year_full_week" = "All year, full week",
                              "All_year_part_week" = "All year, part week")) +
  theme(axis.text.x = element_text(angle=15), legend.position = 'bottom')
```

Figure \@ref(fig:employmentstatus) illustrates that majority of the employed women work for the entire year. Specifically, majority of them work full week. There are few women who work occasionally. On top of that, regardless of what their employment status is, there are more women who have one or more child under six. 

```{r employmentstatuschildcare, echo=FALSE, fig.cap="Distribution of child's caretaker by work status"}
# caretaker aspect
emply_caretaker <-
  emply_long %>%
  filter(str_detect(variable, "^caretaker_")) %>%
  mutate(variable = str_replace_all(variable, "caretaker_", "")) %>%
  rename(caretaker = variable,
         percentage = count) %>%
  mutate(
    caretaker = factor(caretaker, 
                       levels = c('respondent',
                                  'partner',
                                  'other_relative',
                                  'neighbor',
                                  'hired',
                                  'child_in_school',
                                  'other_female_child',
                                  'other_male_child',
                                  'not_worked_since_birth',
                                  'other',
                                  'missing')
    )
  )

# plot the bar graph
emply_caretaker %>%
  ggplot(mapping=aes(x=caretaker, y=percentage, fill=caretaker)) +
  geom_bar(stat = "identity", position="dodge") + 
  theme_minimal() +
  labs(x='',
       caption = 'Respondent is currently employed but has not worked since last birth.') +
  theme(legend.position='none') +
  coord_flip() + 
  scale_x_discrete(
    labels = 
      c("respondent" = "respondent",
        "partner" = "partner",
        "other_relative" = "relative",
        "neighbor" = "neighbor",
        "hired" = "hired",
        "child_in_school" = "schooling",
        "other_child" = "siblings",
        "not_worked_since_birth" = "not worked since birth",
        "other" = "other",
        "missing" = "missing")
  ) +
  facet_wrap(vars(background),
             dir = "v",
             scales = "free",
             labeller = labeller(background = c("All_year_full_week" = "All year, full week",
                                                "All_year_part_week" = "All year, part week",
                                                "Seasonal" = "Seasonal",
                                                "Occasional" = "Occasional")
                                 )
  )

```

We can see from Figure \@ref(fig:employmentstatuschildcare) that the percentage of the respondent being the primary caretaker of the child under six is remarkably higher than the others in all four employment status. It exceeds 40% in all four cases, and in particular, it is close to 50% when they work all year, full week. Next, it is the relatives who mainly take care of the child under six. It should be noted that there are more women sending their kids under six to school when they work all year compare to the ones who do not work throughout the entire year. 

# Discussions

## Child's caretaker

Every figure that demonstrates the distribution of the child's caretaker shows that it is most likely to be the mother primarily taking care of their child under six. In other words, no matter where they live, what their education level is, and what type of a job they have, majority of the employed women is the primary caregiver of a child under six. Therefore, we can deduce that in Ghana it was common that the mother is primarily responsible for the care and raising of a child back in 1988.

Besides the mother being the primary caregiver of a child under six, it can be observed from Figure \@ref(fig:mothereduchildcare), Figure \@ref(fig:workstatuschildcare), Figure \@ref(fig:occupationchildcare), Figure \@ref(fig:employmentstatuschildcare) that the relatives are likely to be the primary caregiver. Also, there are some family where the older siblings take care of their kids under six. Thus, we can tell that if there is a child under six in the family, then it was usual for the family member to take care of them in Ghana, 1988. 

In addition, we can observe that it is uncommon to hire a person to take care of the child under six. Instead of hiring a person, there are more cases reported that they sent the kids to school. Figure \@ref(fig:areachildcare) demonstrates that the percentage of the employed women sending their kids to school is higher in urban areas than in rural areas. Figure \@ref(fig:mothereduchildcare) shows that there are more women who send their kids to school as their education level gets higher. Figure \@ref(fig:workstatuschildcare) illustrates that it is more likely to have their kids in school when they work for someone else than when they work for the family member or when they are self-employed. Figure \@ref(fig:occupationchildcare) shows that the percentage of the employed women sending their kids to school is higher in non-agricultural sectors than in agricultural sectors. Lastly, we can see from Figure \@ref(fig:employmentstatuschildcare) that there are more women sending their kids to school when they work all year compare to the ones who work seasonally and occasionally. 

Lastly, we can tell that it is rarely the case that the mother stop working after having a birth. However, it is worth noting that the percentage of the employed women stop working after the birth is higher in urban areas than in rural areas from Figure \@ref(fig:areachildcare). In addition, Figure \@ref(fig:mothereduchildcare) shows that the women who completed high school tend to stop working after having a birth more than the ones with a lower education level. Moreover, the fact that the women who work for someone else are more likely to stop work since the last birth than the ones working for themselves or their family can be observed in Figure \@ref(fig:workstatuschildcare). Furthermore, Figure \@ref(fig:employmentstatuschildcare) shows that the percentage of the employed women stop working after the birth is higher among the women working all year than the ones working few times of the year. 

## Limitation and weaknesses

The number does not add up to 100. (round-off error)

'Mother's education level' might not be the accurate terminology to be used as it might be the case that the employed women not having any child. 

\newpage

# References